# AutoVend 需求分析文档

## 1. 项目概述

AutoVend 是一个智能汽车销售AI代理系统，旨在通过分析客户聊天记录，自动提取用户信息并分析其购车需求，从而提供个性化的汽车推荐服务。系统能够智能地区分显性需求和隐性需求，并根据用户的特征标签进行购车建议。

## 2. 核心功能需求

### 2.1 用户画像提取

#### 2.1.1 动态用户画像创建与更新
- 系统能从对话中提取用户基本信息，包括性别、年龄、个性特征、汽车知识水平等
- 能够根据对话内容动态更新用户画像
- 支持多轮对话中持续补充和完善用户信息

#### 2.1.2 智能用户关联
- 支持关联识别，识别用户是为自己还是为家人/朋友购车
- 当用户为他人购车时，系统记录该个人信息，并保留特定标签
- 若此人下次通过特定电话号码联系，系统能自动切换到预留画像

#### 2.1.3 用户画像离线补充
- 提供线下工作人员在客户完成线下流程后补充或修改用户画像的功能
- 线下收集的信息能无缝整合到系统画像中

#### 2.1.4 标签动态关联与提取
- 自动将用户画像内容关联转化为潜在需求标签
- 根据地理位置、专业水平等生成对话策略偏好标签
- 例如：<居住哈尔滨>-<电动车=低，隐性>，<专业度=3>-<对话风格专业>

### 2.2 购车需求分析

#### 2.2.1 显性与隐性需求区分
- 显性需求：用户直接表述的需求，如30万预算、偏好宝马或奔驰
- 隐性需求：系统从对话中推断的需求，如安全性、操作简便性等

#### 2.2.2 需求标签化处理
- 显性需求提取标签如<预算=30万>、<品牌=宝马，奔驰>
- 隐性需求推断标签如<安全性=高，隐性>、<操作性=简单，隐性>

#### 2.2.3 多粒度需求分类
- 需求按不同粒度分类，可根据用户专业度进行动态关联
- 例如：外观（包括品牌、尺寸、型号、颜色、轮毂）、能耗（油耗/电耗、油箱容量等）

#### 2.2.4 需求动态精细化控制
- 支持需求粒度的动态控制和调整
- 例如：从隐性推断的<天窗=是，隐性>可根据用户明确表述升级为<全景天窗=是>

#### 2.2.5 冲突需求处理
- 能够处理用户表述中的需求冲突
- 采用后表述需求覆盖先前需求的原则动态更新

## 3. 技术架构

### 3.1 后端架构
- 使用Python作为主要开发语言
- 采用FastAPI构建Web API服务
- 使用OpenAI SDK作为对话引擎
- 采用模块化设计，包括对话管理模块、用户画像模块、需求分析模块和推荐引擎

### 3.2 数据存储
- 初期使用JSON文件存储（本地部署）
- 用户画像数据存储
- 对话历史记录存储
- 购车需求数据存储
- 车型标签数据库

### 3.3 对话处理
- 使用OpenAI API进行自然语言处理和对话生成
- 通过提示工程优化对话交互
- 实现对话流管理和状态转换

### 3.4 对话流管理
- 实现基于状态机的对话流管理
- 支持多轮对话中的上下文保持
- 基于用户画像和需求动态调整对话策略

## 4. 对话流程

### 4.1 欢迎阶段
- 查询已有用户画像
- 若匹配到历史用户，加载用户画像并友好问候
- 若为新用户，自我介绍并创建新用户画像
- 询问目标驾驶者和预算范围

### 4.2 需求分析阶段
- 基于用户画像推断初始需求
- 按重要性询问关键需求（品牌、用途等）
- 后台进行分析并生成需求建议
- 确认用户的需求添加、更新和移除

### 4.3 确认阶段
- 根据分析结果推荐车型
- 根据用户需求标签介绍所选车型
- 允许用户更新需求
- 确认最终车型选择

### 4.4 4S店对接
- 匹配合适的销售人员
- 处理无库存、时间安排等特殊情况

## 5. 系统接口

### 5.1 API接口
- 对话会话管理API
- 用户画像管理API
- 需求分析与更新API
- 车型推荐API

### 5.2 OpenAI集成接口
- 对话生成接口
- 信息提取接口
- 需求分析接口

## 6. 实现策略

### 6.1 短期实现目标
- 完成基础OpenAI集成
- 实现基本对话流管理
- 开发简单的用户画像提取功能
- 实现简单的显性需求识别
- 创建简单的车型数据库和匹配逻辑

### 6.2 中期实现目标
- 增强用户画像的准确性和丰富度
- 改进隐性需求推断能力
- 优化对话体验和流程
- 扩展车型数据库和标签系统
